USE [LIVE]
GO
/****** Object:  StoredProcedure [dbo].[GGP_SP_Durchsatz]    Script Date: 22.12.2017 11:13:11 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		DSI
-- Create date: 14.10.2015
-- Description:	Speichert täglichen Durchsatz ausgewählten Anlagen
-- =============================================
ALTER PROCEDURE  [dbo].[GGP_SP_Durchsatz]
	@Case_ varchar(255) = '',
	@para1 varchar(255) = '',
	@para2 varchar(255) = '',
	@para3 varchar(255) = '',
	@para4 varchar(255) = '',
	@para5 varchar(255) = '',
	@para6 varchar(255) = '',
	@para7 varchar(255) = '',
	@para8 varchar(255) = '',
	@para9 varchar(255) = '',
	@para10 varchar(255) = '', 
	@para11 varchar(255) = '',
	@para12 varchar(255) = '', 
	@para13 varchar(2000) = '',
	@val1 numeric(10, 0) = 0,
	@val2 numeric(10, 0) = 0,
	@val3 numeric(10, 0) = 0,
	@val4 numeric(10, 0) = 0,
	@val5 numeric(10, 0) = 0,
	@val6 decimal(10, 0) = 0,
	@val7 decimal(10, 0) = 0,
	@val8 decimal(10, 0) = 0,
	@val9 decimal(10, 0) = 0,
	@val10 decimal(10, 0) = 0,
	@OUTPUT_RES AS varchar(1000) = '' OUTPUT
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	
	IF @Case_ = 'Black Hole Einmalig'
	BEGIN
		/*
		DECLARE 
		@DatumVon varchar(255),
		@DatumBis varchar(255)
		SET @DatumVon = '01.01.2010'	--Datum Von
		SET @DatumBis = '15.10.2015'	--Datum Bis

		DELETE FROM LIVE2.dbo.Durchsatz_ZUm2 WHERE Anlage_PTR = 1

		INSERT LIVE2.dbo.Durchsatz_ZUm2(Anlage_PTR, ZU_m2, Datum, Bezeichnung)
		SELECT
			Anlage_PTR,
			ZU_m2,
			Datum,
			Bezeichnung
		FROM
		(
			SELECT   
				1 AS Anlage_PTR,
				ROUND(ISNULL((SUM(
					(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
					/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
				), 0), 4) AS ZU_m2,
				dbo.DATA0048.TDATE AS Datum,
				'Black Hole' As Bezeichnung
			FROM         dbo.DATA0006 INNER JOIN
						  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
			WHERE    
						dbo.DATA0048.TDATE >= CONVERT(DATETIME, @DatumVon, 103) 
						AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @DatumBis, 103) 
						AND dbo.DATA0034.DEPT_CODE = 'BLHO-01-01'
			GROUP BY
				dbo.DATA0048.TDATE
		) AS tblDurchsatz
		*/
		SELECT * FROM LIVE2.dbo.Durchsatz_ZUm2
	END





	--------------------------------------------------------------
	-- Durchsatz pro Monat
	--------------------------------------------------------------
	IF @Case_ = 'AnzStunden_Produktiv'
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						ISNULL(SUM(CAST(DATEDIFF(n, LIVE2.dbo.Inst_Arbeitszeit.StartDatumZeit, LIVE2.dbo.Inst_Arbeitszeit.EndDatumZeit) AS FLOAT) / 60.0), 0) AS RES
					FROM LIVE2.dbo.Inst_Arbeitszeit
					WHERE
						LIVE2.dbo.Inst_Arbeitszeit.StartDatumZeit >= CONVERT(DATETIME, @para1, 103)
						AND LIVE2.dbo.Inst_Arbeitszeit.StartDatumZeit <= CONVERT(DATETIME, @para2, 103)
			), 0) AS AnzStunden_Produktiv
	END

	IF @Case_ = 'AnzStunden_Anwesenheit'
	BEGIN
		SELECT
			ISNULL((
					SELECT
						sum(Ist) AS RES
					FROM
					(
						SELECT DISTINCT 
							ID_MSAccess,
							Ist
						FROM 
							LIVE2.dbo.AnwStd
						WHERE
							Datum >= CONVERT(DATETIME, @para1, 103)
							AND Datum <= CONVERT(DATETIME, @para2, 103)
							AND Fehlgrund='ISTAZ'
							AND Kst=100
							--AND Name='Vorwälder, Michael'
					) AS tblAZ
			), 0) AS AnzStunden_Anwesenheit
	END



	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
					SELECT
						SUM(RES) AS VK_m2
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0052.RKEY AS D52_PTR,
							(
								(dbo.ARTIKELDATEN.KNX * dbo.ARTIKELDATEN.KNY * CAST(CAST(dbo.DATA0052.QUAN_SHP AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_KN + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
												dbo.DATA0053 ON dbo.DATA0006.RKEY = dbo.DATA0053.WORK_ORDER_PTR INNER JOIN
												dbo.DATA0052 ON dbo.DATA0053.RKEY = dbo.DATA0052.DATA0053_PTR INNER JOIN
												dbo.DATA0064 ON dbo.DATA0052.SO_SHP_PTR = dbo.DATA0064.RKEY INNER JOIN
												dbo.DATA0060 ON dbo.DATA0064.SO_PTR = dbo.DATA0060.RKEY INNER JOIN
												dbo.DATA0010 ON dbo.DATA0060.CUSTOMER_PTR = dbo.DATA0010.RKEY INNER JOIN
												dbo.DATA0050 ON dbo.DATA0060.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
												dbo.DATA0008 ON dbo.DATA0050.PROD_CODE_PTR = dbo.DATA0008.RKEY INNER JOIN
												dbo.ARTIKELDATEN ON dbo.DATA0050.RKEY = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE
							dbo.DATA0064.DATE_SHIPPED >= CONVERT(DATETIME, @para1, 103)
							AND dbo.DATA0064.DATE_SHIPPED <= CONVERT(DATETIME, @para2, 103)
					) AS tblVKm2
			), 0) AS VK_m2_mitHandel
	END

	IF @Case_ = 'Versand'
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY
						WHERE     
								LEFT(dbo.DATA0050.CP_REV, 1) <> '3'
								AND dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
								AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
								AND dbo.DATA0034.DEPT_NAME LIKE 'VERSAND%'
					) AS tblZUm2ChemSn		
			), 0) AS ZU_m2,
			0 AS ObFl_m2,
			0 AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'VERS-01-01'
					) AS tblAnzStdVersand		
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			ISNULL((
						SELECT TOP 1
							SUM(
								(CAST(CAST(dbo.DATA0048.QTY_PROD AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_KN + 0.9999 AS INT))
								)
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'VERS-01-01'
			), 0) As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			ISNULL((
					SELECT TOP 1    
						--ELP x (KNX x KNY/ELP_Zu)
						SUM(
							(dbo.ARTIKELDATEN.KNX * dbo.ARTIKELDATEN.KNY * CAST(CAST(dbo.DATA0048.QTY_PROD AS FLOAT) 
							/ dbo.ARTIKELDATEN.ELP_KN + 0.9999 AS INT) / 1000000))
						AS RES
					FROM         dbo.DATA0006 INNER JOIN
											dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY
					WHERE    
								LEFT(dbo.DATA0050.CP_REV, 1) <> '3'
								AND dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
								AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
								AND dbo.DATA0034.DEPT_NAME LIKE 'VERSAND%'
			), 0) As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			/*
			ISNULL((
					SELECT
						SUM(RES) AS VK_m2
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0052.RKEY AS D52_PTR,
							(
								(dbo.ARTIKELDATEN.KNX * dbo.ARTIKELDATEN.KNY * CAST(CAST(dbo.DATA0052.QUAN_SHP AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_KN + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
												dbo.DATA0053 ON dbo.DATA0006.RKEY = dbo.DATA0053.WORK_ORDER_PTR INNER JOIN
												dbo.DATA0052 ON dbo.DATA0053.RKEY = dbo.DATA0052.DATA0053_PTR INNER JOIN
												dbo.DATA0064 ON dbo.DATA0052.SO_SHP_PTR = dbo.DATA0064.RKEY INNER JOIN
												dbo.DATA0060 ON dbo.DATA0064.SO_PTR = dbo.DATA0060.RKEY INNER JOIN
												dbo.DATA0010 ON dbo.DATA0060.CUSTOMER_PTR = dbo.DATA0010.RKEY INNER JOIN
												dbo.DATA0050 ON dbo.DATA0060.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
												dbo.DATA0008 ON dbo.DATA0050.PROD_CODE_PTR = dbo.DATA0008.RKEY INNER JOIN
												dbo.ARTIKELDATEN ON dbo.DATA0050.RKEY = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE
							LEFT(dbo.DATA0050.CP_REV, 1) <> '3'
							AND dbo.DATA0064.DATE_SHIPPED >= CONVERT(DATETIME, @para1, 103)
							AND dbo.DATA0064.DATE_SHIPPED <= CONVERT(DATETIME, @para2, 103)
					) AS tblVKm2
			), 0) AS VK_m2,
			*/
			ISNULL((
						SELECT TOP 1
							SUM(
								(dbo.ARTIKELDATEN.KNX * dbo.ARTIKELDATEN.KNY * CAST(CAST(dbo.DATA0048.QTY_PROD AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_KN + 0.9999 AS INT) / 1000000)
								)
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'VERS-01-01'
			), 0) AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'Siebdruck' --'Siebdruck / Pastenlabor'
	BEGIN
		SELECT
			0 AS ZU_m2,
			0 AS ObFl_m2,
			ISNULL((
						SELECT TOP 1
							SUM(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
												dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
												dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
												dbo.DATA0056 ON dbo.DATA0048.TPUT_PTR = dbo.DATA0056.RKEY LEFT OUTER JOIN --INNER JOIN
												dbo.DATA0038 ON dbo.DATA0056.STEP = dbo.DATA0038.STEP_NUMBER AND dbo.DATA0056.WO_PTR = dbo.DATA0038.SOURCE_PTR INNER JOIN
												dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     (dbo.DATA0038.TTYPE = 2)
									AND dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'SDA-'
			), 0) AS Anz_ZU,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) --* CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END 
								)
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'SDA-'
					) AS tblAnzZuSeitenSieb	
			), 0) AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'SDA-'
					) AS tblAnzStdSieb	
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'QS-QM'
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1    
						SUM(
							(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000)) 
						AS RES
					FROM         dbo.DATA0006 INNER JOIN
								  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
								  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
								  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
					WHERE    
								dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
								AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
								AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'KLEB'
								AND dbo.DATA0048.RKEY NOT IN (
																SELECT
																	MaxID
																FROM
																(
																	SELECT 
																		COUNT(dbo.DATA0048.RKEY) AS RES,
																		MAX(dbo.DATA0048.RKEY) AS MaxID,
																		dbo.DATA0006.WORK_ORDER_NUMBER
																	FROM         dbo.DATA0006 INNER JOIN
																				  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
																				  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
																				  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
																	WHERE    
																				dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
																				AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
																				AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'KLEB' AND dbo.DATA0048.QTY_PROD>0
																				
																	GROUP BY
																	dbo.DATA0006.WORK_ORDER_NUMBER
																) AS tblWOGrp
																WHERE RES>1
															)
			), 0) AS ZU_m2,
			0 AS ObFl_m2,
			0 AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(
								CAST((DATEDIFF(mi , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) 
								, dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE) ) 
							) AS NUMERIC(10, 4)))AS Anz_Sekunden
					FROM         dbo.DATA0006 INNER JOIN
										  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
										  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
										  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR INNER JOIN
										  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
										  dbo.DATA0056 ON dbo.DATA0048.TPUT_PTR = dbo.DATA0056.RKEY INNER JOIN
										  dbo.DATA0038 ON dbo.DATA0056.STEP = dbo.DATA0038.STEP_NUMBER AND dbo.DATA0056.WO_PTR = dbo.DATA0038.SOURCE_PTR INNER JOIN
										  dbo.DATA0005 ON dbo.DATA0059.EMPL_PTR = dbo.DATA0005.RKEY INNER JOIN
										  dbo.ARTIKELDATEN ON dbo.DATA0050.RKEY = dbo.ARTIKELDATEN.CUST_PART_PTR
					WHERE   
							(dbo.DATA0038.TTYPE = 2) 
							AND dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
							AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
							AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'KLEB'
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			ISNULL((
					SELECT TOP 1
							COUNT(LIVE2.dbo.QSSchliffe.Schliffnummer) AS RES
					FROM         dbo.DATA0006 INNER JOIN
										  LIVE2.dbo.QSSchliffe ON dbo.DATA0006.RKEY = LIVE2.dbo.QSSchliffe.D0006Ptr
					WHERE    
							LIVE2.dbo.QSSchliffe.Schliffdatum >= CONVERT(DATETIME, @para1, 103) 
							AND LIVE2.dbo.QSSchliffe.Schliffdatum <= CONVERT(DATETIME, @para2, 103) 	
			), 0) As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'AV'
	BEGIN
		SELECT
			0 AS ZU_m2,
			0 AS ObFl_m2,
			0 AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			0 AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			ISNULL((
					SELECT COUNT(RKEY) AS RES
					FROM
						dbo.DATA0060
					WHERE
						dbo.DATA0060.ENT_DATE >= CONVERT(DATETIME, @para1, 103) 
						AND dbo.DATA0060.ENT_DATE <= CONVERT(DATETIME, @para2, 103) 
			), 0) AS Anz_Auftraege,
			ISNULL((
					/*
					SELECT
						COUNT(WORK_ORDER_NUMBER) AS AnzFA
					FROM
					(
						SELECT DISTINCT dbo.DATA0006.WORK_ORDER_NUMBER
											FROM         dbo.DATA0006 INNER JOIN
														  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
														  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
														  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE LEFT(dbo.DATA0034.DEPT_CODE, 3) = 'CAM'
					) AS tblCAM
					WHERE
						 WORK_ORDER_NUMBER IN (
												SELECT 
													'  -' + BASE_WO + '-01-000'
												FROM         dbo.DATA0006 INNER JOIN
															  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
															  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
															  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
													WHERE   
															dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
															AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
															AND dbo.DATA0034.DEPT_CODE LIKE 'FILM%'
												)
					
					SELECT
						COUNT(D6_PTR) AS Anz_neue_FAs
					FROM
					(
						SELECT DISTINCT 
							dbo.DATA0006.RKEY AS D6_PTR,
							dbo.DATA0006.WORK_ORDER_NUMBER AS FA,
							dbo.DATA0034.DEPT_CODE,
							dbo.DATA0050.*
		
						FROM         dbo.DATA0006 INNER JOIN
											dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY
						WHERE 
							LEFT(dbo.DATA0034.DEPT_CODE, 6) = 'CAM-01'
							AND dbo.DATA0006.ROOT_PTR = 0
							AND dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
							AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
							AND dbo.DATA0006.RKEY IN (
														SELECT DISTINCT 
															dbo.DATA0006.RKEY
														FROM         dbo.DATA0006 INNER JOIN
																			dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
																			dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
																			dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
																			dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY
														WHERE 
															LEFT(dbo.DATA0034.DEPT_CODE, 6) = 'CAM-02'
															AND dbo.DATA0006.ROOT_PTR = 0
															AND dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
															AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
													)
					) AS tblAnzFAs
					*/
					SELECT
						COUNT(D6_PTR) AS Anz_neue_FAs
					FROM
					(
						SELECT DISTINCT 
							dbo.DATA0006.RKEY AS D6_PTR,
							dbo.DATA0006.WORK_ORDER_NUMBER AS FA,
							dbo.DATA0034.DEPT_CODE,
							dbo.DATA0050.*
		
						FROM         dbo.DATA0006 INNER JOIN
											dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY
						WHERE 
							LEFT(dbo.DATA0034.DEPT_CODE, 6) = 'CAM-01'
							AND dbo.DATA0006.ROOT_PTR = 0
							AND dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
							AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
							AND dbo.DATA0006.RKEY IN (
														SELECT DISTINCT 
															dbo.DATA0006.RKEY
														FROM         dbo.DATA0006 INNER JOIN
																			dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
																			dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
																			dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
																			dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY
														WHERE 
															LEFT(dbo.DATA0034.DEPT_CODE, 6) = 'CAM-02'
															AND dbo.DATA0006.ROOT_PTR = 0
															AND dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
															AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
													)
					) AS tblAnzFAs
			), 0)  AS Anz_neueFA,
			/*
			ISNULL((
					SELECT COUNT(FA) as NEU
					FROM
					(
						SELECT DISTINCT
								 BASE_WO AS FA
						FROM         dbo.DATA0006 INNER JOIN
										  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
										  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
										  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY
						WHERE   
								dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
								AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
								AND dbo.DATA0006.ROOT_PTR = 0
								AND LEFT(dbo.DATA0006.WORK_ORDER_NUMBER, 1) NOT IN ('R', 'S', 'W')
								--AND LEFT(dbo.DATA0034.DEPT_CODE, 3) ='DNC'
								--AND SUBSTRING(dbo.DATA0006.WORK_ORDER_NUMBER, 11, 2) = '01'
								--AND LEFT(dbo.DATA0006.WORK_ORDER_NUMBER, 2) = '  '
					) as tblFANeu
			), 0) AS Anz_neueFA,
			*/
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			ISNULL((
					SELECT TOP 1
						COUNT(FA) AS RES
					FROM
					(
						SELECT DISTINCT
							LEFT(dbo.DATA0006.WORK_ORDER_NUMBER, 10) AS FA 
						FROM         dbo.DATA0006 
						WHERE    
							dbo.DATA0006.ENT_DATE >= CONVERT(DATETIME, @para1, 103) 
							AND dbo.DATA0006.ENT_DATE <= CONVERT(DATETIME, @para2, 103) 
							AND dbo.DATA0006.ROOT_PTR = 0
							AND LEFT(dbo.DATA0006.WORK_ORDER_NUMBER, 1) NOT IN ('R', 'W', 'S')
					) AS tblHFA 
			), 0) AS Anz_HauptFA
	END

	IF @Case_ = 'CAM'
	BEGIN
		SELECT
			0 AS ZU_m2,
			0 AS ObFl_m2,
			0 AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			ISNULL((
					SELECT COUNT(FA) as NEU
					FROM
					(
						SELECT DISTINCT
								 '  -' + BASE_WO + '-01-000' AS FA
						FROM         dbo.DATA0006 INNER JOIN
										  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
										  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
										  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY
						WHERE   
								dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
								AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
								AND dbo.DATA0006.ROOT_PTR = 0
								AND LEFT(dbo.DATA0034.DEPT_CODE, 3) ='DNC'
								AND SUBSTRING(dbo.DATA0006.WORK_ORDER_NUMBER, 11, 2) = '01'
								AND LEFT(dbo.DATA0006.WORK_ORDER_NUMBER, 2) = '  '
					) as tblFANeu
			), 0) AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND DATA0006.ROOT_PTR=0
									AND LEFT(dbo.DATA0034.DEPT_CODE, 3) IN ('CAM', 'DNC')
					) AS tblAnzStdCAM			
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			/*
			ISNULL((
					SELECT
						SUM(RES) AS AnzLE
					FROM
					(	
						SELECT 
							FA,
							(LE) as RES
						FROM
						(
							SELECT DISTINCT
								dbo.DATA0006.WORK_ORDER_NUMBER AS FA,
								dbo.ARTIKELDATEN.LE
							FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
							WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND DATA0006.ROOT_PTR=0
									AND LEFT(dbo.DATA0034.DEPT_CODE, 3) ='DNC'
									AND SUBSTRING(dbo.DATA0006.WORK_ORDER_NUMBER, 11, 2) = '01'
									AND LEFT(dbo.DATA0006.WORK_ORDER_NUMBER, 2) = '  '
						) as tblAend

						UNION ALL

						SELECT 
							FA,
							(LE) as RES
						FROM
						(
							SELECT DISTINCT
								dbo.DATA0006.WORK_ORDER_NUMBER AS FA,
								dbo.ARTIKELDATEN.LE
							FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
							WHERE   
										dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
										AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
										AND DATA0006.ROOT_PTR=0
										AND LEFT(dbo.DATA0034.DEPT_CODE, 3) IN ('CAM', 'DNC')
										AND SUBSTRING(dbo.DATA0006.WORK_ORDER_NUMBER, 11, 2) = '01'
										AND LEFT(dbo.DATA0006.WORK_ORDER_NUMBER, 2) = '  '
						) as tblAend
						WHERE
							FA NOT IN (
									SELECT DISTINCT
										dbo.DATA0006.WORK_ORDER_NUMBER
									FROM         dbo.DATA0006 INNER JOIN
												  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
												  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
												  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY
									WHERE   
											dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
											AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
											AND DATA0006.ROOT_PTR=0
											AND LEFT(dbo.DATA0034.DEPT_CODE, 3) ='DNC'
											AND SUBSTRING(dbo.DATA0006.WORK_ORDER_NUMBER, 11, 2) = '01'
											AND LEFT(dbo.DATA0006.WORK_ORDER_NUMBER, 2) = '  '
									)
					) AS tblSumLagen	
			), 0) AS Anz_LE_je_FA,
			*/
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS Summe
					FROM
					(
						SELECT Distinct
							dbo.DATA0006.WORK_ORDER_NUMBER AS FA,
							(dbo.ARTIKELDATEN.LE) AS RES
						FROM         dbo.DATA0006 INNER JOIN
											dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE   
								dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
								AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
								AND DATA0006.ROOT_PTR=0
								AND LEFT(dbo.DATA0034.DEPT_CODE, 3) IN ('DNC', 'CAM')
								AND SUBSTRING(dbo.DATA0006.WORK_ORDER_NUMBER, 11, 2) = '01'
								AND LEFT(dbo.DATA0006.WORK_ORDER_NUMBER, 2) = '  '
					) AS tblAnz_LE_je_FA
			), 0) AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'Fotolabor'
	BEGIN
		SELECT
			0 AS ZU_m2,
			0 AS ObFl_m2,
			0 AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			ISNULL((
				SELECT TOP 1
					COUNT(WORK_ORDER_NUMBER) AS AnzFA
				FROM
				(
					SELECT DISTINCT dbo.DATA0006.WORK_ORDER_NUMBER
										FROM         dbo.DATA0006 INNER JOIN
														dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
														dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
														dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
				) AS tblCAM
				WHERE
						WORK_ORDER_NUMBER IN (
											SELECT 
												'  -' + BASE_WO + '-01-000'
											FROM         dbo.DATA0006 INNER JOIN
															dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
															dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
															dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
												WHERE   
														dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
														AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
														AND dbo.DATA0034.DEPT_CODE LIKE 'FILM%'
											)			
			), 0) AS Anz_FA,
			0 AS Anz_AnwStd,

			0 AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,

			ISNULL((
					SELECT
						COUNT(WORK_ORDER_NUMBER) AS AnzFA
					FROM
					(
						SELECT DISTINCT dbo.DATA0006.WORK_ORDER_NUMBER
											FROM         dbo.DATA0006 INNER JOIN
														  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
														  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
														  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE LEFT(dbo.DATA0034.DEPT_CODE, 3) = 'CAM'
					) AS tblCAM
					WHERE
						 WORK_ORDER_NUMBER IN (
												SELECT 
													'  -' + BASE_WO + '-01-000'
												FROM         dbo.DATA0006 INNER JOIN
															  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
															  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
															  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
													WHERE   
															dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
															AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
															AND dbo.DATA0034.DEPT_CODE LIKE 'FILM%'
												)
			), 0)  AS Anz_neueFA,

			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			ISNULL((
				SELECT TOP 1
					SUM(RES) AS Durchsatz
				FROM
				(
					SELECT	
							ISNULL((
								CAST(ISNULL((
									SELECT
										SUM(ISNULL(tblDATA0095.QUANTITY, 0)) AS RES
									FROM
									(
										SELECT     LIVE2.dbo.MatRueck_Anlage.ID AS Anlage_PTR, LIVE2.dbo.MatRueck_Anlage.Anlage, dbo.DATA0017.RKEY AS D17_RKEY, dbo.DATA0017.INV_PART_DESCRIPTION AS ArtBezeichnung,
													dbo.DATA0002.UNIT_CODE AS Lagereinheit, dbo.DATA0017.STOCK_PURCH 
										FROM         LIVE2.dbo.MatRueck_Abteilung INNER JOIN
												  LIVE2.dbo.MatRueck_Transaktion ON LIVE2.dbo.MatRueck_Abteilung.ID = LIVE2.dbo.MatRueck_Transaktion.Abteilung_PTR INNER JOIN
												  LIVE2.dbo.MatRueck_Anlage ON LIVE2.dbo.MatRueck_Transaktion.Anlage_PTR = LIVE2.dbo.MatRueck_Anlage.ID INNER JOIN
												  dbo.DATA0017 ON LIVE2.dbo.MatRueck_Transaktion.D17_Art_PTR = dbo.DATA0017.RKEY INNER JOIN
												  dbo.DATA0002 ON dbo.DATA0017.STOCK_UNIT_PTR = dbo.DATA0002.RKEY INNER JOIN
												  dbo.DATA0034 ON LIVE2.dbo.MatRueck_Transaktion.D34_Dept_PTR = dbo.DATA0034.RKEY
										WHERE dbo.DATA0034.DEPT_CODE = 'FOTL-01-01'
										GROUP BY LIVE2.dbo.MatRueck_Anlage.ID, LIVE2.dbo.MatRueck_Anlage.Anlage, dbo.DATA0017.RKEY, dbo.DATA0017.INV_PART_DESCRIPTION , dbo.DATA0017.STOCK_PURCH, dbo.DATA0002.UNIT_CODE 
										HAVING LIVE2.dbo.MatRueck_Anlage.ID = 64 --FL Silberfilme
									) AS tblAnlageArtikel INNER JOIN --LEFT OUTER JOIN 
									(SELECT QUANTITY, INVT_PTR, YEAR(TRAN_DATE) AS Jahr, TRAN_DATE, MONTH(TRAN_DATE) AS Monat, TRAN_TP 
									--FROM dbo.DATA0095 INNER JOIN  dbo.DATA0034 ON dbo.DATA0095.SRCE_PTR = dbo.DATA0034.RKEY 
									FROM dbo.DATA0095 LEFT OUTER JOIN dbo.DATA0034 ON dbo.DATA0095.SRCE_PTR = dbo.DATA0034.RKEY
									WHERE dbo.DATA0095.TRAN_TP IN (15, 16) AND dbo.DATA0034.DEPT_CODE = 'FOTL-01-01'
									AND dbo.DATA0095.TRAN_DATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0095.TRAN_DATE <= CONVERT(DATETIME, @para2, 103)  AND dbo.DATA0095.INVT_PTR = D17.RKEY ) AS tblDATA0095 
									ON tblAnlageArtikel.D17_RKEY = tblDATA0095.INVT_PTR
									--) AS myTblSub	
								), 0)
								+
								ISNULL((
									SELECT 
										ISNULL((
											(-1)*SUM(QUANTITY) 
											*
											ISNULL((
												SELECT TOP 1 CAST(LIVE2.dbo.NachKalk_MatVerteilung.Verteilung_Prozent AS NUMERIC(10, 4))/100
												FROM LIVE2.dbo.NachKalk_MatVerteilung
												WHERE LIVE2.dbo.NachKalk_MatVerteilung.Anlage_PTR = 64 --FL Silberfilme
														AND LIVE2.dbo.NachKalk_MatVerteilung.D17_PTR = D17.RKEY 
											), 1) 
										), 0) AS RES 

									FROM 
										dbo.DATA0095 LEFT OUTER JOIN dbo.DATA0034 ON dbo.DATA0095.SRCE_PTR = dbo.DATA0034.RKEY
									WHERE 
										dbo.DATA0095.TRAN_TP = 23
										AND dbo.DATA0095.TRAN_DATE >= CONVERT(DATETIME, @para1, 103) 
										AND dbo.DATA0095.TRAN_DATE <= CONVERT(DATETIME, @para2, 103) 
										AND dbo.DATA0095.INVT_PTR = D17.RKEY 
								), 0) AS NUMERIC(10, 4))
								*
								CAST(REPLACE(D17.ANALYSIS_CODE5, ',', '.') AS NUMERIC(10, 4))
						), 0) AS RES
					FROM dbo.DATA0017 AS D17
					WHERE D17.RKEY IN (955, 1221)
				) AS tblFilm_m2
			), 0) AS Film_m2,
			0 AS Anz_HauptFA

	END

	IF @Case_ = 'Zuschnitt'
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									--AND DATA0006.ROOT_PTR=0
									AND dbo.DATA0034.DEPT_CODE = 'ZU-01-01'
					) AS tblZUm2ZU			
			), 0) AS ZU_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'ZU-01-01'
					) AS tblZUm2HAL		
			), 0) AS ObFl_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'ZU-01-01'
					) AS tblAnzZuHAL		
			), 0) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'ZU-01-01'
					) AS tblAnzStdHAL		
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'ML-Presse'
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									--AND DATA0006.ROOT_PTR=0
									AND dbo.DATA0034.DEPT_CODE IN ('MLPR-01-01', 'MLPR-01-02', 'MLPR-01-03', 'MLPR-01-04', 'MLPR-01-05')
					) AS tblZUm2MLPressen			
			), 0) AS ZU_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('MLPR-01-01', 'MLPR-01-02', 'MLPR-01-03', 'MLPR-01-04', 'MLPR-01-05')
					) AS tblZUm2HAL		
			), 0) AS ObFl_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('MLPR-01-01', 'MLPR-01-02', 'MLPR-01-03', 'MLPR-01-04', 'MLPR-01-05')
					) AS tblAnzZuHAL		
			), 0) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			/*
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('MLPR-01-01', 'MLPR-01-02', 'MLPR-01-03', 'MLPR-01-04', 'MLPR-01-05')
					) AS tblAnzStdHAL		
			), 0) AS Anz_AbmStd,
			*/
			ISNULL((
					SELECT TOP 1
						CAST((RES * 135.0 / 60.0) As FLOAT) AS AnzStd
					FROM
					(
						SELECT 
							COUNT(ID) AS RES
						FROM LIVE2.dbo.Nachkalk_MLPressZeiten
						WHERE 
							CAST(LEFT(JahrMonat, 4) AS INT) = YEAR(CONVERT(DATETIME, @para1, 103))
							AND CAST(RIGHT(JahrMonat, 2) AS INT) = MONTH(CONVERT(DATETIME, @para1, 103))
							--DateiZuletztGeschriebenAm >= CONVERT(DATETIME, @para1, 103) 
							--AND DateiZuletztGeschriebenAm <= CONVERT(DATETIME, @para2, 103) 
					) AS tblAnzStd		
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'ML - Plasma - Ätze'
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									--AND DATA0006.ROOT_PTR=0
									AND dbo.DATA0034.DEPT_CODE = 'MLPL-01-01'
					) AS tblZUm2Plasma			
			), 0) AS ZU_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'MLPL-01-01'
					) AS tblZUm2HAL		
			), 0) AS ObFl_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'MLPL-01-01'
					) AS tblAnzZuHAL		
			), 0) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'MLPL-01-01'
					) AS tblAnzStdHAL		
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'Mikroätze'
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									--AND DATA0006.ROOT_PTR=0
									AND dbo.DATA0034.DEPT_CODE = 'MERE-01-03'
					) AS tblZUm2Mikro			
			), 0) AS ZU_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'MERE-01-03'
					) AS tblZUm2HAL		
			), 0) AS ObFl_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'MERE-01-03'
					) AS tblAnzZuHAL		
			), 0) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'MERE-01-03'
					) AS tblAnzStdHAL		
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'Haftvermittler'
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									--AND DATA0006.ROOT_PTR=0
									AND dbo.DATA0034.DEPT_CODE = 'MLBL-01-01'
					) AS tblZUm2BlackOxide			
			), 0) AS ZU_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'MLBL-01-01'
					) AS tblZUm2HAL		
			), 0) AS ObFl_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'MLBL-01-01'
					) AS tblAnzZuHAL		
			), 0) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'MLBL-01-01'
					) AS tblAnzStdHAL		
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'Desmear'
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									--AND DATA0006.ROOT_PTR=0
									AND dbo.DATA0034.DEPT_CODE = 'MLDS-01-01'
					) AS tblZUm2Desmear			
			), 0) AS ZU_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'MLDS-01-01'
					) AS tblZUm2HAL		
			), 0) AS ObFl_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'MLDS-01-01'
					) AS tblAnzZuHAL		
			), 0) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'MLDS-01-01'
					) AS tblAnzStdHAL		
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'Black Hole'
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									--AND DATA0006.ROOT_PTR=0
									AND dbo.DATA0034.DEPT_CODE = 'BLHO-01-01'
					) AS tblZUm2BlackHole		
			), 0) AS ZU_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'BLHO-01-01'
					) AS tblZUm2HAL		
			), 0) AS ObFl_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'BLHO-01-01'
					) AS tblAnzZuHAL		
			), 0) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'BLHO-01-01'
					) AS tblAnzStdHAL		
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'Ätzen alkalisch'
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
												dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
												dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
												dbo.DATA0056 ON dbo.DATA0048.TPUT_PTR = dbo.DATA0056.RKEY LEFT OUTER JOIN --INNER JOIN
												dbo.DATA0038 ON dbo.DATA0056.STEP = dbo.DATA0038.STEP_NUMBER AND dbo.DATA0056.WO_PTR = dbo.DATA0038.SOURCE_PTR INNER JOIN
												dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     (dbo.DATA0038.TTYPE = 2)
									AND dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) IN ('ÄTZA', 'STSN')
									AND (LEFT(dbo.DATA0038.PARAMETER_2, 3)='1.C' OR dbo.DATA0038.PARAMETER_2='' OR dbo.DATA0038.PARAMETER_2='.')
					) AS tblZUm2AetzAlkalisch		
			), 0) AS ZU_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
												dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
												dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
												dbo.DATA0056 ON dbo.DATA0048.TPUT_PTR = dbo.DATA0056.RKEY LEFT OUTER JOIN --INNER JOIN
												dbo.DATA0038 ON dbo.DATA0056.STEP = dbo.DATA0038.STEP_NUMBER AND dbo.DATA0056.WO_PTR = dbo.DATA0038.SOURCE_PTR INNER JOIN
												dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) IN ('ÄTZA', 'STSN')
									AND (LEFT(dbo.DATA0038.PARAMETER_2, 3)='1.C' OR dbo.DATA0038.PARAMETER_2='' OR dbo.DATA0038.PARAMETER_2='.')
					) AS tblZUm2HAL		
			), 0) AS ObFl_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
												dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
												dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
												dbo.DATA0056 ON dbo.DATA0048.TPUT_PTR = dbo.DATA0056.RKEY LEFT OUTER JOIN --INNER JOIN
												dbo.DATA0038 ON dbo.DATA0056.STEP = dbo.DATA0038.STEP_NUMBER AND dbo.DATA0056.WO_PTR = dbo.DATA0038.SOURCE_PTR INNER JOIN
												dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) IN ('ÄTZA', 'STSN')
									AND (LEFT(dbo.DATA0038.PARAMETER_2, 3)='1.C' OR dbo.DATA0038.PARAMETER_2='' OR dbo.DATA0038.PARAMETER_2='.')
					) AS tblAnzZuHAL		
			), 0) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0056 ON dbo.DATA0048.TPUT_PTR = dbo.DATA0056.RKEY LEFT OUTER JOIN
											  dbo.DATA0038 ON dbo.DATA0056.STEP = dbo.DATA0038.STEP_NUMBER AND dbo.DATA0056.WO_PTR = dbo.DATA0038.SOURCE_PTR INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) IN ('ÄTZA', 'STSN')
									AND (LEFT(dbo.DATA0038.PARAMETER_2, 3)='1.C' OR dbo.DATA0038.PARAMETER_2='' OR dbo.DATA0038.PARAMETER_2='.')
					) AS tblAnzStdHAL		
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'Ätzen sauer'
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
												dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
												dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
												dbo.DATA0056 ON dbo.DATA0048.TPUT_PTR = dbo.DATA0056.RKEY LEFT OUTER JOIN --INNER JOIN
												dbo.DATA0038 ON dbo.DATA0056.STEP = dbo.DATA0038.STEP_NUMBER AND dbo.DATA0056.WO_PTR = dbo.DATA0038.SOURCE_PTR INNER JOIN
												dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     (dbo.DATA0038.TTYPE = 2)
									AND dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) IN ('ÄTZS-', ' ÄS-MA')
									AND (LEFT(dbo.DATA0038.PARAMETER_2, 3)='1.C' OR dbo.DATA0038.PARAMETER_2='' OR dbo.DATA0038.PARAMETER_2='.')
					) AS tblZUm2AetzSauer		
			), 0) AS ZU_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
												dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
												dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
												dbo.DATA0056 ON dbo.DATA0048.TPUT_PTR = dbo.DATA0056.RKEY LEFT OUTER JOIN --INNER JOIN
												dbo.DATA0038 ON dbo.DATA0056.STEP = dbo.DATA0038.STEP_NUMBER AND dbo.DATA0056.WO_PTR = dbo.DATA0038.SOURCE_PTR INNER JOIN
												dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) IN ('ÄTZS-', ' ÄS-MA')
									AND (LEFT(dbo.DATA0038.PARAMETER_2, 3)='1.C' OR dbo.DATA0038.PARAMETER_2='' OR dbo.DATA0038.PARAMETER_2='.')
					) AS tblZUm2HAL		
			), 0) AS ObFl_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
												dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
												dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
												dbo.DATA0056 ON dbo.DATA0048.TPUT_PTR = dbo.DATA0056.RKEY LEFT OUTER JOIN --INNER JOIN
												dbo.DATA0038 ON dbo.DATA0056.STEP = dbo.DATA0038.STEP_NUMBER AND dbo.DATA0056.WO_PTR = dbo.DATA0038.SOURCE_PTR INNER JOIN
												dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) IN ('ÄTZS-', ' ÄS-MA')
									AND (LEFT(dbo.DATA0038.PARAMETER_2, 3)='1.C' OR dbo.DATA0038.PARAMETER_2='' OR dbo.DATA0038.PARAMETER_2='.')
					) AS tblAnzZuHAL		
			), 0) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0056 ON dbo.DATA0048.TPUT_PTR = dbo.DATA0056.RKEY LEFT OUTER JOIN
											  dbo.DATA0038 ON dbo.DATA0056.STEP = dbo.DATA0038.STEP_NUMBER AND dbo.DATA0056.WO_PTR = dbo.DATA0038.SOURCE_PTR INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) IN ('ÄTZS-', ' ÄS-MA')
									AND (LEFT(dbo.DATA0038.PARAMETER_2, 3)='1.C' OR dbo.DATA0038.PARAMETER_2='' OR dbo.DATA0038.PARAMETER_2='.')
					) AS tblAnzStdHAL		
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'LBA'
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('LBA-04-04', 'LBA-04-05', 'LBA-M-01') 
					) AS tblZUm2LBA		
			), 0) AS ZU_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('LBA-04-04', 'LBA-04-05', 'LBA-M-01') 
					) AS tblZUm2HAL		
			), 0) AS ObFl_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('LBA-04-04', 'LBA-04-05', 'LBA-M-01') 
					) AS tblAnzZuHAL		
			), 0) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('LBA-04-04', 'LBA-04-05', 'LBA-M-01') 
					) AS tblAnzStdHAL		
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'HAL'
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('HBL-01-01', 'HBF-01-01')
					) AS tblZUm2HAL		
			), 0) AS ZU_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('HBL-01-01', 'HBF-01-01')
					) AS tblZUm2HAL		
			), 0) AS ObFl_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('HBL-01-01', 'HBF-01-01')
					) AS tblAnzZuHAL		
			), 0) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('HBL-01-01', 'HBF-01-01')
					) AS tblAnzStdHAL		
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'HAL BL'
	BEGIN
		SELECT
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'HBL-01-01'
					) AS tblZUm2HAL		
			), 0) AS FLOAT) AS ZU_m2,
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'HBL-01-01'
					) AS tblZUm2HAL		
			), 0) AS FLOAT) AS ObFl_m2,
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'HBL-01-01'
					) AS tblAnzZuHAL		
			), 0) AS FLOAT) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'HBL-01-01'
					) AS tblAnzStdHAL		
			), 0) AS FLOAT) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'HAL BL Ext'
	BEGIN
		SELECT
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'HBLX'
					) AS tblZUm2HAL		
			), 0) AS FLOAT) AS ZU_m2,
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'HBLX'
					) AS tblZUm2HAL		
			), 0) AS FLOAT) AS ObFl_m2,
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'HBLX'
					) AS tblAnzZuHAL		
			), 0) AS FLOAT) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'HBLX'
					) AS tblAnzStdHAL		
			), 0) AS FLOAT) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'HAL BF'
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'HBF-01-01'
					) AS tblZUm2HAL		
			), 0) AS ZU_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'HBF-01-01'
					) AS tblZUm2HAL		
			), 0) AS ObFl_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'HBF-01-01'
					) AS tblAnzZuHAL		
			), 0) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'HBF-01-01'
					) AS tblAnzStdHAL		
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'HAL BF Ext'
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'HBFX'
					) AS tblZUm2HAL		
			), 0) AS ZU_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'HBFX'
					) AS tblZUm2HAL		
			), 0) AS ObFl_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'HBFX'
					) AS tblAnzZuHAL		
			), 0) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'HBFX'
					) AS tblAnzStdHAL		
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'Chem. Ni / Au' --'Chem. NiAu'
	BEGIN
			SELECT
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'CGIN-01-01'
					) AS tblZUm2HAL		
			), 0) AS FLOAT) AS ZU_m2,
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'CGIN-01-01'
					) AS tblZUm2HAL		
			), 0) AS FLOAT) AS ObFl_m2,
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'CGIN-01-01'
					) AS tblAnzZuHAL		
			), 0) AS FLOAT) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'CGIN-01-01'
					) AS tblAnzStdHAL		
			), 0) AS FLOAT) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'Chem. NiAu Ext'
	BEGIN
			SELECT
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE LIKE 'CG-E%'
					) AS tblZUm2HAL		
			), 0) AS FLOAT) AS ZU_m2,
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE LIKE 'CG-E%'
					) AS tblZUm2HAL		
			), 0) AS FLOAT) AS ObFl_m2,
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE LIKE 'CG-E%'
					) AS tblAnzZuHAL		
			), 0) AS FLOAT) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE LIKE 'CG-E%'
					) AS tblAnzStdHAL		
			), 0) AS FLOAT) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ =  'Chem Sn' --'Chem. Zinn'
	BEGIN
			SELECT
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'CZIN-01-01'
					) AS tblZUm2HAL		
			), 0) AS FLOAT) AS ZU_m2,
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'CZIN-01-01'
					) AS tblZUm2HAL		
			), 0) AS FLOAT) AS ObFl_m2,
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'CZIN-01-01'
					) AS tblAnzZuHAL		
			), 0) AS FLOAT) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'CZIN-01-01'
					) AS tblAnzStdHAL		
			), 0) AS FLOAT) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'Chem. Zinn Ext'
	BEGIN
			SELECT
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE LIKE 'CZ-E%'
					) AS tblZUm2HAL		
			), 0) AS FLOAT) AS ZU_m2,
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE LIKE 'CZ-E%'
					) AS tblZUm2HAL		
			), 0) AS FLOAT) AS ObFl_m2,
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE LIKE 'CZ-E%'
					) AS tblAnzZuHAL		
			), 0) AS FLOAT) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE LIKE 'CZ-E%'
					) AS tblAnzStdHAL		
			), 0) AS FLOAT) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'FL: chem. Silber'
	BEGIN
		--DECLARE 
		--@para1 varchar(255),
		--@para2 varchar(255)
		--SET @para1 = '01.01.2011'	--Datum Von
		--SET @para2 = '31.12.2015'	--Datum Bis

		SELECT
			--FL,
			SUM(ZU_m2) AS ZU_m2,
			SUM(ObFl_m2) AS ObFl_m2,
			SUM(CAST(REMenge AS INT)) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,
			0 AS Anz_AbmStd,
			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2
		FROM
		(
			SELECT
				FL,
				(ZuX * ZuY * REMenge / 1000000) AS ZU_m2,
				(
					(ZuX * ZuY * REMenge / 1000000) 
					* 
					CASE WHEN LE > 1 THEN 2 ELSE 1 END
				)
				AS ObFl_m2,
				REMenge
			FROM
			(
				SELECT     
					LTRIM(REPLACE(dbo.DATA0072.DESCRIPTION, 'DL: ', '')) AS FL, 
					LTRIM(RIGHT(RTRIM(dbo.DATA0072.DESCRIPTION2), 9)) AS LPNummer, 
					dbo.DATA0107.INV_DATE, 
					dbo.DATA0109.QUANTITY AS REMenge
				FROM         dbo.DATA0023 INNER JOIN
									  dbo.DATA0070 INNER JOIN
									  dbo.DATA0072 ON dbo.DATA0070.RKEY = dbo.DATA0072.POPTR ON dbo.DATA0023.RKEY = dbo.DATA0070.SUPPLIER_POINTER INNER JOIN --LEFT OUTER JOIN
									  dbo.DATA0107 INNER JOIN
									  dbo.DATA0109 ON dbo.DATA0107.RKEY = dbo.DATA0109.DATA0107_PTR ON dbo.DATA0072.RKEY = dbo.DATA0109.DATA0072_PTR
				WHERE     (dbo.DATA0072.DESCRIPTION2 <> '') AND (LEFT(dbo.DATA0072.DESCRIPTION, 3) = 'DL:')
			) AS tblRE LEFT OUTER JOIN
			(
				SELECT DISTINCT dbo.ARTIKELDATEN.LE, dbo.ARTIKELDATEN.ZuX, dbo.ARTIKELDATEN.ZuY, dbo.ARTIKELDATEN.ELP_Zu, RTRIM(dbo.DATA0050.CUSTOMER_PART_NUMBER) + '.' + RTRIM(dbo.DATA0050.CP_REV) AS LP
				FROM         dbo.ARTIKELDATEN INNER JOIN
									  dbo.DATA0050 ON dbo.ARTIKELDATEN.CUST_PART_PTR = dbo.DATA0050.RKEY 
			) AS D50 ON tblRE.LPNummer = D50.LP
			WHERE
				INV_DATE >= CONVERT(DATETIME, @para1, 103) 
				AND INV_DATE <= CONVERT(DATETIME, @para2, 103) 
		) AS tblFLGrp
		WHERE
			FL ='chem. Silber'
		GROUP BY
			FL
	END

	/* Intern chem Silber gibt es nicht bei GGP Stand 20.07.2017 / Dsi in Absprache mit Jha
	IF @Case_ = 'Chem. Silber'
	BEGIN
			SELECT
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE LIKE 'CS-%'
					) AS tblZUm2HAL		
			), 0) AS FLOAT) AS ZU_m2,
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE LIKE 'CS-%'
					) AS tblZUm2HAL		
			), 0) AS FLOAT) AS ObFl_m2,
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE LIKE 'CS-%'
					) AS tblAnzZuHAL		
			), 0) AS FLOAT) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE LIKE 'CS-%'
					) AS tblAnzStdHAL		
			), 0) AS FLOAT) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2
	END
	*/

	IF @Case_ = 'Chem. Silber Ext'
	BEGIN
			SELECT
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE LIKE 'CS-E%'
					) AS tblZUm2HAL		
			), 0) AS FLOAT) AS ZU_m2,
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE LIKE 'CS-E%'
					) AS tblZUm2HAL		
			), 0) AS FLOAT) AS ObFl_m2,
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE LIKE 'CS-E%'
					) AS tblAnzZuHAL		
			), 0) AS FLOAT) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE LIKE 'CS-E%'
					) AS tblAnzStdHAL		
			), 0) AS FLOAT) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'Fotodruck'
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('FOTO-01-01', 'FOTO-01-02', 'FOTO-02-01', 'FOTO-02-02', 'FOTO-02-03')
					) AS tblZUm2Fotodruck		
			), 0) AS ZU_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('FOTO-01-01', 'FOTO-01-02', 'FOTO-02-01', 'FOTO-02-02', 'FOTO-02-03')
					) AS tblZUm2HAL		
			), 0) AS ObFl_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('FOTO-01-01', 'FOTO-01-02', 'FOTO-02-01', 'FOTO-02-02', 'FOTO-02-03')
					) AS tblAnzZuFotodruck	
			), 0) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('FOTO-01-01', 'FOTO-01-02', 'FOTO-02-01', 'FOTO-02-02', 'FOTO-02-03')
					) AS tblAnzStdHAL		
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
												dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
												dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
												dbo.DATA0056 ON dbo.DATA0048.TPUT_PTR = dbo.DATA0056.RKEY LEFT OUTER JOIN --INNER JOIN
												dbo.DATA0038 ON dbo.DATA0056.STEP = dbo.DATA0038.STEP_NUMBER AND dbo.DATA0056.WO_PTR = dbo.DATA0038.SOURCE_PTR INNER JOIN
												dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     (dbo.DATA0038.TTYPE = 2) AND
									(dbo.DATA0048.TDATE >=CONVERT(DATETIME, @para1, 103)) 
									AND (dbo.DATA0048.TDATE <=CONVERT(DATETIME, @para2, 103)) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'LAMI'
									AND (
											(dbo.DATA0038.PARAMETER_2 = '1.Laminat.AL;' OR dbo.DATA0038.PARAMETER_2 = '2.Laminat.AL;')
											OR 
											((dbo.DATA0038.PARAMETER_2 = '' OR dbo.DATA0038.PARAMETER_2 = '.') AND dbo.DATA0006.ROOT_PTR=0)
										)
					) AS tblZUm2Fotodruck		
			), 0) AS ZUm2_LaminierenAL
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
												dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
												dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
												dbo.DATA0056 ON dbo.DATA0048.TPUT_PTR = dbo.DATA0056.RKEY LEFT OUTER JOIN --INNER JOIN
												dbo.DATA0038 ON dbo.DATA0056.STEP = dbo.DATA0038.STEP_NUMBER AND dbo.DATA0056.WO_PTR = dbo.DATA0038.SOURCE_PTR INNER JOIN
												dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     (dbo.DATA0038.TTYPE = 2) AND
									(dbo.DATA0048.TDATE >=CONVERT(DATETIME, @para1, 103)) 
									AND (dbo.DATA0048.TDATE <=CONVERT(DATETIME, @para2, 103)) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'LAMI'
									AND (
											(dbo.DATA0038.PARAMETER_2 = '1.Laminat.IL;' OR dbo.DATA0038.PARAMETER_2 = '2.Laminat.IL;')
											OR 
											((dbo.DATA0038.PARAMETER_2 = '' OR dbo.DATA0038.PARAMETER_2 = '.') AND dbo.DATA0006.ROOT_PTR>0)
										)
					) AS tblZUm2Fotodruck		
			), 0) AS ZUm2_LaminierenIL
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
												dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
												dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
												dbo.DATA0056 ON dbo.DATA0048.TPUT_PTR = dbo.DATA0056.RKEY LEFT OUTER JOIN --INNER JOIN
												dbo.DATA0038 ON dbo.DATA0056.STEP = dbo.DATA0038.STEP_NUMBER AND dbo.DATA0056.WO_PTR = dbo.DATA0038.SOURCE_PTR INNER JOIN
												dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     (dbo.DATA0038.TTYPE = 2) AND
									(dbo.DATA0048.TDATE >=CONVERT(DATETIME, @para1, 103)) 
									AND (dbo.DATA0048.TDATE <=CONVERT(DATETIME, @para2, 103)) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'LAMI'
									AND (dbo.DATA0038.PARAMETER_2 = '1.Laminat.GvAuAg;' OR dbo.DATA0038.PARAMETER_2 = '2.Laminat.GvAuAg;')
					) AS tblZUm2Fotodruck		
			), 0) AS ZUm2_LaminierenGvAuAg
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
												dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
												dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
												dbo.DATA0056 ON dbo.DATA0048.TPUT_PTR = dbo.DATA0056.RKEY LEFT OUTER JOIN --INNER JOIN
												dbo.DATA0038 ON dbo.DATA0056.STEP = dbo.DATA0038.STEP_NUMBER AND dbo.DATA0056.WO_PTR = dbo.DATA0038.SOURCE_PTR INNER JOIN
												dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     (dbo.DATA0038.TTYPE = 2) AND
									(dbo.DATA0048.TDATE >=CONVERT(DATETIME, @para1, 103)) 
									AND (dbo.DATA0048.TDATE <=CONVERT(DATETIME, @para2, 103)) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'SDA-'
									AND dbo.DATA0038.PARAMETER_2 LIKE '%StLack%'
					) AS tblZUm2Fotodruck		
			), 0) AS ZUm2_Siebdr_Stopplack
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
												dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
												dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
												dbo.DATA0056 ON dbo.DATA0048.TPUT_PTR = dbo.DATA0056.RKEY LEFT OUTER JOIN --INNER JOIN
												dbo.DATA0038 ON dbo.DATA0056.STEP = dbo.DATA0038.STEP_NUMBER AND dbo.DATA0056.WO_PTR = dbo.DATA0038.SOURCE_PTR INNER JOIN
												dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     (dbo.DATA0038.TTYPE = 2) AND
									(dbo.DATA0048.TDATE >=CONVERT(DATETIME, @para1, 103)) 
									AND (dbo.DATA0048.TDATE <=CONVERT(DATETIME, @para2, 103)) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'SDA-'
									AND dbo.DATA0038.PARAMETER_2 LIKE '%Isolack%'
					) AS tblZUm2Fotodruck		
			), 0) AS ZUm2_Siebdr_Isolierlack
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
												dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
												dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
												dbo.DATA0056 ON dbo.DATA0048.TPUT_PTR = dbo.DATA0056.RKEY LEFT OUTER JOIN --INNER JOIN
												dbo.DATA0038 ON dbo.DATA0056.STEP = dbo.DATA0038.STEP_NUMBER AND dbo.DATA0056.WO_PTR = dbo.DATA0038.SOURCE_PTR INNER JOIN
												dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     (dbo.DATA0038.TTYPE = 2) AND
									(dbo.DATA0048.TDATE >=CONVERT(DATETIME, @para1, 103)) 
									AND (dbo.DATA0048.TDATE <=CONVERT(DATETIME, @para2, 103)) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'SDA-'
									AND dbo.DATA0038.PARAMETER_2 LIKE '%KzDruck%'
					) AS tblZUm2Fotodruck		
			), 0) AS ZUm2_Siebdr_KDDruck
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
												dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
												dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
												dbo.DATA0056 ON dbo.DATA0048.TPUT_PTR = dbo.DATA0056.RKEY LEFT OUTER JOIN --INNER JOIN
												dbo.DATA0038 ON dbo.DATA0056.STEP = dbo.DATA0038.STEP_NUMBER AND dbo.DATA0056.WO_PTR = dbo.DATA0038.SOURCE_PTR INNER JOIN
												dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     (dbo.DATA0038.TTYPE = 2) AND
									(dbo.DATA0048.TDATE >=CONVERT(DATETIME, @para1, 103)) 
									AND (dbo.DATA0048.TDATE <=CONVERT(DATETIME, @para2, 103)) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'SDA-'
									AND dbo.DATA0038.PARAMETER_2 LIKE '%AZLack%'
					) AS tblZUm2Fotodruck		
			), 0) AS ZUm2_Siebdr_Abziehlack
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
												dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
												dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
												dbo.DATA0056 ON dbo.DATA0048.TPUT_PTR = dbo.DATA0056.RKEY LEFT OUTER JOIN --INNER JOIN
												dbo.DATA0038 ON dbo.DATA0056.STEP = dbo.DATA0038.STEP_NUMBER AND dbo.DATA0056.WO_PTR = dbo.DATA0038.SOURCE_PTR INNER JOIN
												dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     (dbo.DATA0038.TTYPE = 2) AND
									(dbo.DATA0048.TDATE >=CONVERT(DATETIME, @para1, 103)) 
									AND (dbo.DATA0048.TDATE <=CONVERT(DATETIME, @para2, 103)) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'SDA-'
									AND dbo.DATA0038.PARAMETER_2 LIKE '%Carbon%'
					) AS tblZUm2Fotodruck		
			), 0) AS ZUm2_Siebdr_Carbon
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
												dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
												dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
												dbo.DATA0056 ON dbo.DATA0048.TPUT_PTR = dbo.DATA0056.RKEY LEFT OUTER JOIN --INNER JOIN
												dbo.DATA0038 ON dbo.DATA0056.STEP = dbo.DATA0038.STEP_NUMBER AND dbo.DATA0056.WO_PTR = dbo.DATA0038.SOURCE_PTR INNER JOIN
												dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     (dbo.DATA0038.TTYPE = 2) AND
									(dbo.DATA0048.TDATE >=CONVERT(DATETIME, @para1, 103)) 
									AND (dbo.DATA0048.TDATE <=CONVERT(DATETIME, @para2, 103)) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'SDA-'
									AND dbo.DATA0038.PARAMETER_2 LIKE '%WSLack%'
					) AS tblZUm2Fotodruck		
			), 0) AS ZUm2_Siebdr_Wiederstandslack
	END

	IF @Case_ = 'Gießlinie'
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('GIES-02-01', 'GIES-02-02') --= 'GIES-01-01'
					) AS tblAnzZuGiess	
			), 0) AS ZU_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('GIES-02-01', 'GIES-02-02') --= 'GIES-01-01'
					) AS tblZUm2HAL		
			), 0) AS ObFl_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('GIES-02-01', 'GIES-02-02') --= 'GIES-01-01'
					) AS tblAnzZuHAL		
			), 0) AS Anz_ZU,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) * CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END 
								)
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('GIES-02-01', 'GIES-02-02') --= 'GIES-01-01'
					) AS tblAnzZuSeitenGiess	
			), 0) AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('GIES-02-01', 'GIES-02-02') --= 'GIES-01-01'
					) AS tblAnzStdHAL		
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'Gießlinie Bimsen'
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'GIES-01-01'
					) AS tblAnzZuGiess	
			), 0) AS ZU_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'GIES-01-01'
					) AS tblZUm2HAL		
			), 0) AS ObFl_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'GIES-01-01'
					) AS tblAnzZuHAL		
			), 0) AS Anz_ZU,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) * CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END 
								)
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'GIES-01-01'
					) AS tblAnzZuSeitenGiess	
			), 0) AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'GIES-01-01'
					) AS tblAnzStdHAL		
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'Gießlinie Stopplack-Stripper'
	BEGIN
		SELECT
			ISNULL((
					SELECT     
						SUM(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * LIVE2.dbo.Sondermeldungen.RMMenge / 1000000) AS RES
					FROM         LIVE2.dbo.Sondermeldungen INNER JOIN
										  dbo.DATA0006 ON LIVE2.dbo.Sondermeldungen.DATA0006PTR = dbo.DATA0006.RKEY INNER JOIN
										  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
					WHERE
						LIVE2.dbo.Sondermeldungen.RMDatum >= CONVERT(DATETIME, @para1, 103) 
						AND LIVE2.dbo.Sondermeldungen.RMDatum <= CONVERT(DATETIME, @para2, 103)
			), 0) AS ZU_m2,
			0 AS ObFl_m2,
			0 AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			0 AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'Sichtkontrollen'
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('ENDK-01-01', 'PR_2-01-01', 'PR_2-01-02', 'PR_2-01-03', 'PRHA-01-01', 'PSIC-01-01')
					) AS tblZUm2HAL		
			), 0) AS ZU_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'BLHO-01-01'
					) AS tblZUm2HAL		
			), 0) AS ObFl_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
							)
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN (
																	'QS-01-01', 'QS-01-02', 'QS-01-03', 'QS-01-04', 'QS-01-05', 'QS-01-06', 'QS-01-07', 'QS-01-08'
																	, 'ENDK-01-01', 'PHAD-01-01', 'PRHA-01-01', 'PR_2-01-01', 'PR_2-01-02', 'PR_2-01-03', 'PSIC-01-01'	
																)
					) AS tblAnzZuSichtkontrolle		
			), 0) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			ISNULL((
					ISNULL((
						SELECT TOP 1
							sum(Ist) AS RES
						FROM
						(
							SELECT DISTINCT 
								ID_MSAccess,
								Ist
							FROM 
								LIVE2.dbo.AnwStd
							WHERE
								Datum >= CONVERT(DATETIME, @para1, 103)
								AND Datum <= CONVERT(DATETIME, @para2, 103)
								AND Fehlgrund='ISTAZ'
								AND Kst=124
						) AS tblAZ
					), 0)
					+
					ISNULL((
						SELECT TOP 1
							sum(Ist) AS RES
						FROM
						(
							SELECT DISTINCT 
								ID_MSAccess,
								Ist
							FROM 
								LIVE2.dbo.AnwStd
							WHERE
								Datum >= CONVERT(DATETIME, @para1, 103)
								AND Datum <= CONVERT(DATETIME, @para2, 103)
								AND Fehlgrund='ISTAZ'
								AND Kst=125 AND PersNr NOT IN (2410, 2134, 2179, 2501)
						) AS tblAZ
					), 0)
			), 0) AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN (
																	'QS-01-01', 'QS-01-02', 'QS-01-03', 'QS-01-04', 'QS-01-05', 'QS-01-06', 'QS-01-07', 'QS-01-08'
																	, 'ENDK-01-01', 'PHAD-01-01', 'PRHA-01-01', 'PR_2-01-01', 'PR_2-01-02', 'PR_2-01-03', 'PSIC-01-01'	
																)
					) AS tblAnzStdSichtkontrolle		
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'QS-01-08'
					) AS tblZUm2HAL		
			), 0) AS ZUm2_SichtKontr_Klebefolie
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 6) IN ('QS-01-', 'PHAD-0')
					) AS tblZUm2HAL		
			), 0) AS ZUm2_SichtKontr_QSPruef
	END

	IF @Case_ = 'Bohrerei' --'Bohren'
	BEGIN
			SELECT
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('BOHR-01-12', 'BOHR-01-14', 'BOHR-01-17', 'BOHR-01-18', 'BOHR-01-21')
					) AS tblZUm2HAL		
			), 0) AS FLOAT) AS ZU_m2,
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('BOHR-01-12', 'BOHR-01-14', 'BOHR-01-17', 'BOHR-01-18', 'BOHR-01-21')
					) AS tblZUm2HAL		
			), 0) AS FLOAT) AS ObFl_m2,
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('BOHR-01-12', 'BOHR-01-14', 'BOHR-01-17', 'BOHR-01-18', 'BOHR-01-21')
					) AS tblAnzZuHAL		
			), 0) AS FLOAT) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('BOHR-01-12', 'BOHR-01-14', 'BOHR-01-17', 'BOHR-01-18', 'BOHR-01-21')
					) AS tblAnzStdHAL		
			), 0) AS FLOAT) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'Fräserei' --'Fräsen'
	BEGIN
			SELECT
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('FRÄS-01-06', 'FRÄS-01-19', 'FRÄS-01-20', 'FRÄS-01-22')
					) AS tblZUm2HAL		
			), 0) AS FLOAT) AS ZU_m2,
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('FRÄS-01-06', 'FRÄS-01-19', 'FRÄS-01-20', 'FRÄS-01-22')
					) AS tblZUm2HAL		
			), 0) AS FLOAT) AS ObFl_m2,
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('FRÄS-01-06', 'FRÄS-01-19', 'FRÄS-01-20', 'FRÄS-01-22')
					) AS tblAnzZuHAL		
			), 0) AS FLOAT) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('FRÄS-01-06', 'FRÄS-01-19', 'FRÄS-01-20', 'FRÄS-01-22')
					) AS tblAnzStdHAL		
			), 0) AS FLOAT) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = 'Ritzen'
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'RITZ-01-01'
					) AS tblZUm2Ritzen		
			), 0) AS ZU_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'RITZ-01-01'
					) AS tblZUm2HAL		
			), 0) AS ObFl_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'RITZ-01-01'
					) AS tblAnzZuHAL		
			), 0) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'RITZ-01-01'
					) AS tblAnzStdHAL		
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS Lfm
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								ISNULL(dbo.ARTIKELDATEN.RITZWEG, 0) * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT)/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)
								*
								CASE WHEN dbo.ARTIKELDATEN.LPD <= 1.8 THEN 1
										ELSE
											CASE WHEN dbo.ARTIKELDATEN.LPD > 1.8 AND dbo.ARTIKELDATEN.LPD < 2.4 THEN 2
													ELSE 3
											END
								END
								)
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'RITZ-01-01'
					) AS tblLfmRitzen	
			), 0) AS Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END


IF @Case_ = 'E-Test'
	BEGIN
			SELECT
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) IN ('EPFI-', 'EPDS-')
					) AS tblZUm2HAL		
			), 0) AS FLOAT) AS ZU_m2,
			0 AS ObFl_m2,
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) IN ('EPFI-', 'EPDS-')
					) AS tblAnzZuHAL		
			), 0) AS FLOAT) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) IN ('EPFI-', 'EPDS-')
					) AS tblAnzStdRitzen	
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			ISNULL((
						SELECT TOP 1
							SUM(
								(CAST(CAST(dbo.DATA0048.QTY_PROD AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_KN + 0.9999 AS INT))
								)
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) IN ('EPFI-', 'EPDS-')
			), 0) AS Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

IF @Case_ = 'E-Test Hand'
	BEGIN
			SELECT
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('EPHA-01-06')
					) AS tblZUm2HAL		
			), 0) AS FLOAT) AS ZU_m2,
			0 AS ObFl_m2,
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('EPHA-01-06')
					) AS tblAnzZuHAL		
			), 0) AS FLOAT) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('EPHA-01-06')
					) AS tblAnzStdRitzen	
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			ISNULL((
						SELECT TOP 1
							SUM(
								(CAST(CAST(dbo.DATA0048.QTY_PROD AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_KN + 0.9999 AS INT))
								)
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE IN ('EPHA-01-06')
			), 0) AS Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

IF @Case_ = 'E-Finger'
	BEGIN
			SELECT
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) IN ('EPFI-')
					) AS tblZUm2HAL		
			), 0) AS FLOAT) AS ZU_m2,
			0 AS ObFl_m2,
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) IN ('EPFI-')
					) AS tblAnzZuHAL		
			), 0) AS FLOAT) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) IN ('EPFI-')
					) AS tblAnzStdRitzen	
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			ISNULL((
						SELECT TOP 1
							SUM(
								(CAST(CAST(dbo.DATA0048.QTY_PROD AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_KN + 0.9999 AS INT))
								)
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) IN ('EPFI-')
			), 0) AS Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

IF @Case_ = 'ECONO TOWER'
	BEGIN
			SELECT
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) IN ('EPDS-')
					) AS tblZUm2HAL		
			), 0) AS FLOAT) AS ZU_m2,
			0 AS ObFl_m2,
			CAST(ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) IN ('EPDS-')
					) AS tblAnzZuHAL		
			), 0) AS FLOAT) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) IN ('EPDS-')
					) AS tblAnzStdRitzen	
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			ISNULL((
						SELECT TOP 1
							SUM(
								(CAST(CAST(dbo.DATA0048.QTY_PROD AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_KN + 0.9999 AS INT))
								)
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) IN ('EPDS-')
			), 0) AS Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			0 As Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END
	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) IN ('EPDS-')
					) AS tblAnzStdRitzen	
			), 0) AS AnzStunden_ETest
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) = 'EPDS-'
					) AS tblAnzStdRitzen	
			), 0) AS AnzStunden_ETest_EPDS
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) = 'EPFI-'
					) AS tblAnzStdRitzen	
			), 0) AS AnzStunden_ETest_EPFI
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
						SELECT TOP 1
							SUM(
								(CAST(CAST(dbo.DATA0048.QTY_PROD AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_KN + 0.9999 AS INT))
								)
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) IN ('EPFI-', 'EPDS-')
			), 0) AS AnzKN_ETest
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
						SELECT TOP 1
							SUM(
								(CAST(CAST(dbo.DATA0048.QTY_PROD AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_KN + 0.9999 AS INT))
								)
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) = 'EPDS-'
			), 0) AS AnzKN_ETest_EPDS
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
						SELECT TOP 1
							SUM(
								(CAST(CAST(dbo.DATA0048.QTY_PROD AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_KN + 0.9999 AS INT))
								)
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) = 'EPFI-'
			), 0) AS AnzKN_ETest_EPFI
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS Zum2
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) IN ('EPFI-', 'EPDS-')
					) AS tblZUm2ETest		
			), 0) AS ZUm2_ETest
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS Zum2
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) ='EPDS-'
					) AS tblZUm2ETest		
			), 0) AS ZUm2_ETest_EPDS
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS Zum2
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 5) = 'EPFI-'
					) AS tblZUm2ETest		
			), 0) AS ZUm2_ETest_EPFI
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'AOI-01-01'
									AND dbo.DATA0006.ROOT_PTR > 0
					) AS tblAnzStdAOI		
			), 0) AS AnzStunden_AOI_IL
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'AOI-01-01'
									AND dbo.DATA0006.ROOT_PTR = 0
					) AS tblAnzStdAOI		
			), 0) AS AnzStunden_AOI_AL
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
							)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'AOI-01-01'
									AND dbo.DATA0006.ROOT_PTR > 0
					) AS tblAnzZuAOI		
			), 0) AS AnzZu_AOI_IL
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
							)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'AOI-01-01'
									AND dbo.DATA0006.ROOT_PTR = 0
					) AS tblAnzZuAOI		
			), 0) AS AnzZu_AOI_AL
	END

	IF @Case_ = 'AOI'
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									--AND dbo.DATA0034.DEPT_CODE = 'AOI-01-01'
									AND dbo.DATA0034.DEPT_CODE LIKE 'AOI%'
					) AS tblZUm2AOI		
			), 0) AS ZU_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							--(
							--	(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
							--	/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							--AS RES
							(
								dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY 
								* 
								CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ 
								dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) 
								/ 1000000 
								* 
								CASE WHEN dbo.ARTIKELDATEN.LE > 1 THEN 2 ELSE 1 END
							) AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									--AND dbo.DATA0034.DEPT_CODE = 'AOI-01-01'
									AND dbo.DATA0034.DEPT_CODE LIKE 'AOI%'
					) AS tblZUm2HAL		
			), 0) AS ObFl_m2,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)) 
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									--AND dbo.DATA0034.DEPT_CODE = 'AOI-01-01'
									AND dbo.DATA0034.DEPT_CODE LIKE 'AOI%'
					) AS tblAnzZuHAL		
			), 0) AS Anz_ZU,

			0 AS Anz_ZU_Seiten,
			0 AS Anz_FA,
			0 AS Anz_AnwStd,

			ISNULL((
					SELECT TOP 1
						SUM(RES) AS AnzStd
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0059.RKEY,
							(DATEDIFF(n , dbo.UF_ToDateTime(dbo.DATA0059.START_TIME, dbo.DATA0059.START_DATE) , dbo.UF_ToDateTime(dbo.DATA0059.STOP_TIME, dbo.DATA0059.STOP_DATE))) / 60.0 AS RES
						FROM         dbo.DATA0006 INNER JOIN
											  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
											  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
											  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
											  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
											  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						WHERE   
									dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									--AND dbo.DATA0034.DEPT_CODE = 'AOI-01-01'
									AND dbo.DATA0034.DEPT_CODE LIKE 'AOI%'
					) AS tblAnzStdHAL		
			), 0) AS Anz_AbmStd,

			0 AS Anz_erstSiebe,
			0 AS Anz_Analysen,
			0 AS Anz_Auftraege,
			0 AS Anz_neueFA,
			0 As Anz_KN,
			0 AS Anz_LE_je_FA,
			0 As Anz_Schliffe,
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS Lfm
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								ISNULL(dbo.ARTIKELDATEN.RITZWEG, 0) * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT)/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT)
								*
								CASE WHEN dbo.ARTIKELDATEN.LPD <= 1.8 THEN 1
										ELSE
											CASE WHEN dbo.ARTIKELDATEN.LPD > 1.8 AND dbo.ARTIKELDATEN.LPD < 2.4 THEN 2
													ELSE 3
											END
								END
								)
							AS RES
						--FROM         dbo.DATA0006 INNER JOIN
						--					  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
						--					  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
						--					  dbo.DATA0050 ON dbo.DATA0006.CUST_PART_PTR = dbo.DATA0050.RKEY INNER JOIN
						--					  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR INNER JOIN
						--					  dbo.DATA0059 ON dbo.DATA0048.RKEY = dbo.DATA0059.TRAN_PTR
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									--AND dbo.DATA0034.DEPT_CODE = 'AOI-01-01'
									AND dbo.DATA0034.DEPT_CODE LIKE 'AOI%'
					) AS tblLfmRitzen	
			), 0) AS Laufmeter,
			0 As Laufstunden,
			0 As prodGutmenge_VKm2,
			0 As Anz_produktiveStd,
			0 AS VK_m2,
			0 AS Anz_HauptFA
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'AOI-01-01'
									AND dbo.DATA0006.ROOT_PTR > 0
					) AS tblZUm2AOI		
			), 0) AS ZUm2_AOI_IL
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
					SELECT TOP 1
						SUM(RES) AS RES
					FROM
					(
						SELECT DISTINCT
							dbo.DATA0048.RKEY,
							(
								(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000))
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
									  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
									  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
									  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND dbo.DATA0034.DEPT_CODE = 'AOI-01-01'
									AND dbo.DATA0006.ROOT_PTR = 0
					) AS tblZUm2AOI		
			), 0) AS ZUm2_AOI_AL
	END









	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
				SELECT TOP 1
					SUM(RES_) AS RES
				FROM
				(
					SELECT
						ISNULL((
							SELECT TOP 1    
								SUM(
									(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
									/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000)) 
								AS RES
							FROM         dbo.DATA0006 INNER JOIN
										  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
										  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
										  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
							WHERE    
										dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
										AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
										AND dbo.DATA0034.DEPT_CODE IN ('BLHO-01-01', 'MLDS-01-01', 'MERE-01-03', 'CZIN-01-01'
																		, 'GIES-01-01', 'HBF-01-01', 'HBL-01-01', 'MLBL-01-01', 'CGIN-01-01')
						), 0) AS RES_
					UNION ALL
					SELECT
						ISNULL((
							SELECT TOP 1    
								SUM(
									(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
									/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000)) 
								AS RES
							FROM         dbo.DATA0006 INNER JOIN
										  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
										  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
										  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
							WHERE    
										dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
										AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
										AND LEFT(dbo.DATA0034.DEPT_CODE, 4) IN ('ÄTZA', 'STSN')
						), 0) AS RES_
					UNION ALL
					SELECT
						ISNULL((
							SELECT TOP 1    
								SUM(
									(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
									/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000)) 
								AS RES
							FROM         dbo.DATA0006 INNER JOIN
										  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
										  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
										  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
							WHERE    
										dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
										AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
										AND LEFT(dbo.DATA0034.DEPT_CODE, 5) IN ('ÄTZS-', ' ÄS-MA')
						), 0) AS RES_
					UNION ALL
					SELECT
						ISNULL((
							SELECT TOP 1    
								SUM(
									(dbo.ARTIKELDATEN.ZuX * dbo.ARTIKELDATEN.ZuY * CAST(CAST(dbo.DATA0048.QTY_PROD + dbo.DATA0048.QTY_REJECT AS FLOAT) 
									/ dbo.ARTIKELDATEN.ELP_Zu + 0.9999 AS INT) / 1000000)) 
								AS RES
							FROM         dbo.DATA0006 INNER JOIN
										  dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
										  dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
										  dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
							WHERE    
										dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
										AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
										AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'LBA-'
						), 0) AS RES_
				) AS tblAbwDurchsatz
			), 0) AS ZUm2_Abwasser
	END

	IF @Case_ = ''
	BEGIN
		SELECT
			ISNULL((
						SELECT TOP 1
							SUM(
								(CAST(CAST(dbo.DATA0048.QTY_PROD AS FLOAT) 
								/ dbo.ARTIKELDATEN.ELP_KN + 0.9999 AS INT))
								)
							AS RES
						FROM         dbo.DATA0006 INNER JOIN
												dbo.DATA0048 ON dbo.DATA0006.RKEY = dbo.DATA0048.WO_PTR INNER JOIN
												dbo.DATA0034 ON dbo.DATA0048.WORK_CENTER_PTR = dbo.DATA0034.RKEY INNER JOIN
												dbo.DATA0056 ON dbo.DATA0048.TPUT_PTR = dbo.DATA0056.RKEY LEFT OUTER JOIN --INNER JOIN
												dbo.DATA0038 ON dbo.DATA0056.STEP = dbo.DATA0038.STEP_NUMBER AND dbo.DATA0056.WO_PTR = dbo.DATA0038.SOURCE_PTR INNER JOIN
												dbo.ARTIKELDATEN ON dbo.DATA0006.CUST_PART_PTR = dbo.ARTIKELDATEN.CUST_PART_PTR
						WHERE     (dbo.DATA0038.TTYPE = 2)
									AND dbo.DATA0048.TDATE >= CONVERT(DATETIME, @para1, 103) 
									AND dbo.DATA0048.TDATE <= CONVERT(DATETIME, @para2, 103) 
									AND LEFT(dbo.DATA0034.DEPT_CODE, 4) = 'ENDK'
			), 0) AS AnzKN_Endkontrolle
	END
	--------------------------------------------------------------
	--------------------------------------------------------------
END
